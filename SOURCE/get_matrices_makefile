USE_MPI = 1

ifeq ($(USE_MPI),1)
	DEF = -DUSE_MPI
	CC=mpicc
else
	DEF =
	CC=gcc
endif

all: get_matrices.so

%.so: %.o
	$(CC) $^ -shared -Wl,-soname,$@ -o $@
%.o: %.c
	$(CC) $(DEF) $^ -c --std=gnu11 -O2 -fPIC -o $@

clean:
	rm -rf get_matrices.so
